create table ras_rental_history (
  rh_id           number        generated always as identity,
  rh_ren_id       number        not null,
  rh_dev_id       number        not null, 
  rh_u_owner_id   number        not null, 
  rh_u_renter_id  number        not null, 
  rh_start_date   date          not null, 
  rh_end_date     date, 
  rh_total_cost   number(10, 2),
  rh_status       varchar2(20)  default 'completed',
  rh_created      date  default sysdate not null,
  rh_created_by   varchar2(255) default user not null,
  rh_updated_by   varchar2(255),
  rh_updated      date,
  primary key (rh_id),
  constraint fk_rental_history_rental foreign key (rh_ren_id) references ras_rentals(ren_id) on delete cascade,
  constraint fk_device_history foreign key (rh_dev_id) references ras_devices(dev_id),
  constraint fk_user_owner_history foreign key (rh_u_owner_id) references ras_users(u_id),
  constraint fk_user_renter_history foreign key (rh_u_renter_id) references ras_users(u_id)
);

comment on table ras_rental_history is 'table storing the history of device rentals';
comment on column ras_rental_history.rh_id is 'unique identifier for the rental history record';
comment on column ras_rental_history.rh_ren_id is 'identifier of the related rental';
comment on column ras_rental_history.rh_dev_id is 'identifier of the device that was rented';
comment on column ras_rental_history.rh_u_owner_id is 'identifier of the owner of the device';
comment on column ras_rental_history.rh_u_renter_id is 'identifier of the user who rented the device';
comment on column ras_rental_history.rh_start_date is 'rental start date';
comment on column ras_rental_history.rh_end_date is 'rental end date';
comment on column ras_rental_history.rh_total_cost is 'total cost of the rental';
comment on column ras_rental_history.rh_status is 'rental status (e.g., completed, cancelled)';

create index idx_rh_ren_id on ras_rental_history(rh_ren_id);
create index idx_rh_dev_id on ras_rental_history(rh_dev_id);
create index idx_rh_u_owner_id on ras_rental_history(rh_u_owner_id);
create index idx_rh_u_renter_id on ras_rental_history(rh_u_renter_id);
create index idx_rh_start_date on ras_rental_history(rh_start_date);
