create table ras_rentals (
  ren_id           number generated always as identity,
  ren_dev_id       number not null,
  ren_u_id         number not null,
  ren_start_date   date not null,
  ren_end_date     date,
  ren_total_cost   number(12, 2),
  ren_created      date default sysdate not null,
  ren_created_by   varchar2(255) default user not null,
  ren_updated_by   varchar2(255),
  ren_updated      date,
  primary key (ren_id),
  constraint fk_rental_device foreign key (ren_dev_id) references ras_devices(dev_id) on delete set null,
  constraint fk_rental_user_renter foreign key (ren_u_id) references ras_users(u_id) on delete cascade,
  constraint chk_end_date check (ren_end_date >= ren_start_date)
);

comment on table ras_rentals is 'table storing information about device rentals';
comment on column ras_rentals.ren_id is 'unique identifier for the rental';
comment on column ras_rentals.ren_dev_id is 'identifier of the rented device';
comment on column ras_rentals.ren_u_id is 'identifier of the user renting the device';
comment on column ras_rentals.ren_start_date is 'rental start date';
comment on column ras_rentals.ren_end_date is 'rental end date';
comment on column ras_rentals.ren_total_cost is 'total cost of the rental';

create index idx_rentals_dev_id on ras_rentals(ren_dev_id);
create index idx_rentals_u_renter_id on ras_rentals(ren_u_id);
create index idx_rentals_start_date on ras_rentals(ren_start_date);